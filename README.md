# MaiAgent 管理工具集 🚀

![Version](https://img.shields.io/badge/version-4.0.1-blue.svg)
![Python](https://img.shields.io/badge/python-3.7+-green.svg)
![License](https://img.shields.io/badge/license-MIT-orange.svg)
![Platform](https://img.shields.io/badge/platform-Windows%20%7C%20macOS%20%7C%20Linux-lightgrey.svg)

**MaiAgent 管理工具集** 是一個功能強大的圖形化應用程式，專為 MaiAgent AI 助理系統設計，提供全方位的管理和驗證功能。

## ✨ 主要功能

### 🔍 AI 助理回覆品質驗證
- **RAG 增強統計分析**：精確評估 AI 回覆品質
- **批次驗證處理**：支援大量問題同時驗證
- **詳細統計報告**：包含 Precision、Recall、F1-Score、Hit Rate 等指標
- **智能文本匹配**：支援多種段落分隔符和相似度算法

### 👥 組織管理功能
- **組織成員匯出**：完整匯出組織架構和成員資料
- **批量帳號匯入**：自動化建立使用者帳號和組織結構
- **群組權限管理**：靈活配置使用者群組和權限設定
- **CSV 格式支援**：標準化的數據交換格式

### 📚 知識庫管理功能
- **文件列表管理**：瀏覽和管理知識庫中的所有文件
- **批量文件下載**：快速匯出選定的知識庫文件
- **文件上傳功能**：支援多種格式文件上傳至知識庫
- **進度追蹤**：即時顯示操作進度和詳細日誌

### 🎨 圖形化介面
- **直觀操作界面**：現代化的 GUI 設計
- **多分頁管理**：清晰分類的功能模組
- **即時狀態顯示**：操作進度和結果即時反饋
- **日誌記錄系統**：多級別日誌輸出和管理

## 🛠️ 安裝需求

### 系統需求
- **作業系統**：Windows 10+、macOS 10.14+、Linux (Ubuntu 18.04+)
- **Python 版本**：3.7 或更高版本
- **記憶體**：建議 4GB 以上
- **磁碟空間**：至少 500MB 可用空間

### 相依套件

```bash
# 必要套件
aiohttp>=3.8.0
pandas>=1.3.0
tkinter  # Python 標準庫
configparser  # Python 標準庫
```

## 📦 安裝步驟

### 1. 下載專案

```bash
git clone https://github.com/MaiAgent-steven/MaiAgent_GUI_Tool.git
cd MaiAgent_GUI_Tool
```

### 2. 安裝相依套件

```bash
pip install aiohttp pandas
```

### 3. 執行應用程式

```bash
python maiagent_validation_gui.py
```

## 🚀 快速開始

### 設定 API 連線

1. 啟動應用程式後，前往 **「設定」** 分頁
2. 輸入您的 MaiAgent API 資訊：
   - **基礎 URL**：您的 MaiAgent 服務位址（例如：`http://localhost:8000`）
   - **API 金鑰**：您的 API 認證金鑰
3. 點擊 **「測試連線」** 確認設定正確
4. 點擊 **「重新整理 Chatbot 清單」** 載入可用的 AI 助理

### 驗證 AI 回覆品質

1. 前往 **「驗證」** 分頁
2. 點擊 **「瀏覽」** 選擇您的驗證數據 CSV 檔案
3. 設定驗證參數：
   - **相似度閾值**：文本匹配的最低相似度要求（建議 0.3）
   - **最大併發數**：同時處理的請求數量（建議 5）
4. 選擇要驗證的 Chatbot
5. 點擊 **「開始驗證」** 執行批次驗證

### 管理組織成員

1. 前往 **「組織管理」** 分頁
2. 設定 API 連線資訊
3. 選擇要匯出的組織
4. 點擊 **「開始匯出」** 下載組織資料

### 批量部署帳號

1. 前往 **「批量部署」** 分頁
2. 準備符合格式的 CSV 檔案（參考範例格式）
3. 設定部署參數
4. 點擊 **「開始部署」** 執行批量匯入

## 📄 CSV 檔案格式

### 驗證數據格式

驗證用的 CSV 檔案必須包含以下欄位：

| 欄位名稱 | 說明 | 必填 | 範例 |
|---------|------|------|------|
| 編號 | 問題的唯一識別碼 | ✅ | `basic_1` |
| 提問者 | 提問者名稱 | ✅ | `客戶A` |
| 問題描述 | 要驗證的問題內容 | ✅ | `請問營業時間` |
| 建議 or 正確答案 (if have) | 期望的正確答案 | ❌ | `週一到週五 09:00-18:00` |
| 應參考的文件 | 應該引用的文件名稱 | ❌ | `營業資訊` |
| 應參考的文件段落 | 期望引用的文件段落內容 | ❌ | `營業時間說明` |

### 段落分隔符

系統支援多種段落分隔符，用於將長文本分割成獨立段落：

- `---`：三個連字符
- `|||`：三個豎線  
- `\n\n`：雙換行符
- `###`：三個井號
- `===`：三個等號
- `...`：三個點

**範例**：
```
第一段內容---第二段內容|||第三段內容

第四段內容
```

## 📊 RAG 增強統計指標

系統提供詳細的統計分析指標：

- **Precision（精確率）**：檢索到的相關文件中真正相關的比例
- **Recall（召回率）**：所有相關文件中被成功檢索的比例  
- **F1-Score**：精確率和召回率的調和平均數
- **Hit Rate（命中率）**：成功命中期望文件段落的比例

## 🔧 進階設定

### 自訂分隔符

1. 前往 **「設定」** 分頁
2. 在 **「段落分隔符設定」** 區域勾選需要的分隔符
3. 點擊 **「測試分隔符」** 預覽分割效果
4. 點擊 **「重設為預設值」** 恢復預設設定

### 日誌管理

- **日誌等級**：可設定 DEBUG、INFO、WARNING、ERROR
- **日誌匯出**：支援匯出日誌檔案進行分析
- **即時查看**：在應用程式中即時查看操作日誌

### 設定檔自動儲存

應用程式會自動儲存您的設定到 `config.ini` 檔案，下次啟動時自動載入。

## 🤝 貢獻指南

我們歡迎任何形式的貢獻！請遵循以下步驟：

1. Fork 此專案
2. 建立功能分支 (`git checkout -b feature/AmazingFeature`)
3. 提交您的變更 (`git commit -m 'Add some AmazingFeature'`)
4. 推送到分支 (`git push origin feature/AmazingFeature`)
5. 建立 Pull Request

## 🐛 問題回報

如果您發現任何問題或有改善建議，請前往 [Issues](https://github.com/MaiAgent-steven/MaiAgent_GUI_Tool/issues) 頁面回報。

請提供以下資訊：
- 作業系統和 Python 版本
- 錯誤訊息或螢幕截圖
- 重現問題的步驟
- 預期的行為

## 📝 更新日誌

### v4.0.1 (2025-01-27)
- ✨ 新增 RAG 增強統計分析功能
- 🎨 改善圖形化介面設計
- 🐛 修復多個已知問題
- 📚 完善文件和範例

### v3.x
- 🆕 新增組織管理功能
- 🆕 新增知識庫管理功能
- 🔧 改善 API 穩定性

## 📄 授權條款

本專案採用 MIT 授權條款 - 詳見 [LICENSE](LICENSE) 檔案

## 👥 開發團隊

**MaiAgent Team** - *專案維護者*

## 🙏 致謝

感謝所有為此專案做出貢獻的開發者和使用者！

---

**📧 聯絡我們**

如有任何問題或建議，歡迎聯絡 MaiAgent Team

**⭐ 如果這個專案對您有幫助，請給我們一個 Star！** 